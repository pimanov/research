
# Поиска периодческих решений

Поле скорости $\vec v (x,r,\theta,t)$ является периодическим по времени с периодом $T$ в системе отсчета, движущейся со скоростью $c_f$, если оно удовлетворяет уравнению Навье-Стокса, условию несжимаемости и уравнению

$$ \vec v(x,r,\theta,t) = \vec v(x+c_f T,r,\theta,t+T) $$

**Замечание.** Периодичность давления $p$ вытекает из периодичности поля скорости автоматически, так как оно с точностью до аддитивной постоянной восстанавливается по полю скорости в каждый момент времени из уравнения Пуассона (дивергенция от уравнения Навье-Стокса)

$$ \Delta p = div(- (\vec v, \nabla) \vec v)$$

с условием на производную на границе (скалярное произведения уравнения Навье-Стокса с вектором нормали $\vec n$ на границе)

$$ \frac{\partial p}{\partial \vec n} = ( - (\vec v, \nabla)\vec v + \nu \Delta \vec v, \vec n) $$

Давление кинематическое. 

## 1. Определение функции $F(x)$

На практике удобнее сформулировать условие периодичности поля скорости по времени немного иначе, более конструктивно. 

Программа для решения уравнения Навье-Стокса $NS[Re,\Delta t,c_f](\vec v)$ берет на вход некоторое мгновенное поле скорости $\vec v$ и параметры расчета ($Re - $ число Рейнольдса, $\Delta t - $ время, в течении которого интегрировать, $c_f - $ скорость движения системы отчета) и возвращает поле скорости, возникающее через время $\Delta t$.

Соответственно, если поле скорости является периодическим по времени в системе отсчета, движущейся со скоростью $c_f$, с периодом $T$, то оно удовлетворяет уравнению 

$$
F(x) = 0
$$

где $x = (\vec v, Re, T, c_f)$

$F(x) = NS[Re,T,c_f](\vec v) - \vec v $

Я не знаю, как обосновать что-то в непрерывном случае, так что рассуждения далее будут для дискретного случая. Будем считать, что поле скорости задается $n$ переменными. В таком случае в функции $F$ на три неизвестных больше, чем уравнений. 

$$
F: R^{n+3} \to R^n
$$

Программно функция $F$ реализуется самым естественным образом, вызовом уже написанного и отлаженного кода для расчета течения в трубе, без каких-либо модификаций. 

## Решение принадлежит однопараметрическому множеству. 

Пусть $x_0$ - некоторое решение уравнения $F(x) = 0$. Разложим функцию в ряд около этого решения

$$ F(x) = F(x_0) + J_0 \Delta x + O(\Delta x^2) $$

Здесь $\Delta x = x - x_0$, $J_0$ - матрица Якоби, вычисленная в точке $x_0$ 

$$ J_0 \in R^{(n+3) \times n} $$

Если нас интересуют такие малые сдвиги $\Delta x$, которые переводят решение в решение - $F(x_0) = F(x) = 0$, то мы получаем линейную систему на $\Delta x$

$$ J_0 \Delta x = 0 $$

В системе на 3 неизвестных больше, чем уравнений, соответственно решение принадлежит трехмерному пространству, то есть существует три базисных сдвига, которые переводят решение в решение. 

Два из них заранее можно назвать. Это сдвиг вдоль трубы и сдвиг по времени. При этом параметры решения $(Re,T,c_f)$ не меняются. Остается только одно направление, двигаясь вдоль которого можно переходить к решениям с новыми параметрами. В $\epsilon$-окрестности в пространстве параметров все решения принадлежат прямой линии, соответственно, глобально они принадлежат некоторой гладкой кривой - однопараметрическому множеству.

**Замечание.** Можно наложить пару дополнительных условий, чтобы фиксировать фазу решения и его положение в трубе. Тогда будет доступно только одно направление $\Delta x$. Мне кажется, это приведет к снижении скорости сходимости метода. Кроме того, эти условия не естественны, что приводит к сложностям при построении подпространств Крылова, которые используются при решении линейной системы. В общем, они не обязательны, и я их не использую. 

**Замечание.** Нужно отметить, что мы предполагаем, что все уравнения системы $J_0 \Delta x = 0$ линейно независимы. Наверное, в общем случае это так.

**Замечание.** Если добавить в число параметров еще один, например, период решения в угловом направлении, то решения будут принадлежать некоторой гладкой поверхности в пространстве уже четырех параметров. Возможностей найти решения с заданными параметрами становится больше. 

## 2. Метод Ньютона-Крылова

Чтобы найти решение нелинейного уравнения можно воспользоваться методом Ньютона. 

Пусть вектор $x = (u,c_f,T) \in R^{n+2}$. $Re$ фиксировано. На месте числа Рейнольса может быть любой из параметров. Пусть $x_0$ - некоторое начальное приближение к решению. Функцию $F$ можно разложить в ряд около $x_0$

$$
F(x) = F(x_0) + J(x_0)\Delta x + O(\Delta x ^ 2)
$$


Пренебрегая нелинейными членами разложения, полагая, что нас интересует $x$, при котором $F(x) = 0$, получаем систему линейных уравнений на $\Delta x$

$$
J(x_0)\Delta x = - F(x_0)
$$

Новое приближение к решению $x_1 = x_0 + \Delta x$. Метод итерационный. Система прямоугольная и существует произвол при определении $\Delta x$ в две неизвестных, но он связан с возможностью сдвига вдоль трубы и по фазе, как было показано выше. Параметры решения определяются однозначно. 

В общем случае формирование матрицы Якоби и ее решение требует колоссальных ресурсов, но к счастью в этом нет необходимости, так как существуют методы Крыловского типа. В них решение системы $Ax=b$ приближается последовательностью векторов $\{b,Ab,A^2b,A^3b,...\}$, и как правело достаточно небольшого их числа, чтобы получить решение с хорошей точностью. Для их построения достаточно уметь умножать матрицу $A$ на $x$, но в нашем случае 

$$ J_0 \Delta x = \frac{F(x_0 + \epsilon \Delta x) - F(x_0)}{\epsilon} $$

находится численным дифференцирование. Вычисление одного произведения $J_0 \Delta x$ требует вычисления функции $F$ один раз при достаточно малом значении $\epsilon$, при условии, что $F(x_0)$ уже известна. Есть только одна проблема - в подпространствах Крылова матрица квадратная, а в нашем случае прямоугольная. Я придумал несложную модификацию метода GMRES для решения этой задачи. Возможно это очень посредственная модификация, возможно наоборот, многие о такой возможности не догадываются - я не знаю. 

Мне кажется детали реализации самого численного метода уже не представляют большого интереса. То, что он работает и найтенные им решения действительно являеются периодическими по времени, легко убедится подставив их в функцию $F$. То, что решения действительно принадлежит однопараметрическому множеству я посторался показать выше. 
